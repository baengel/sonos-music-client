<section class="queue-section">
  <div class="queue-header" style="display: flex; align-items: center; justify-content: space-between;">
    <h3 style="margin: 0;">Queue</h3>
    <button class="seek-btn queue-btn"
            (click)="onPlayQueue()"
            [disabled]="(queueLoading$ | async)">
      @if (queueLoading$ | async) {
        <span class="spinner"
              style="display: inline-block; width: 1em; height: 1em; border: 2px solid #00b; border-top: 2px solid transparent; border-radius: 50%; animation: spin 0.8s linear infinite;"></span>
      } @else {
        ▶️☰
      }
    </button>
  </div>
  @if (queueLoading$ | async) {
    <div>Lade Queue...</div>
  }
  @if (queueError$ | async) {
    <div>{{ queueError$ | async }}</div>
  }
  @let queue = (queue$ | async);
  @if (!(queueLoading$ | async) && !(queueError$ | async) && queue && queue.length > 0) {
    <ul>
      @for (item of queue; track item; let i = $index) {
        <li style="display: flex; align-items: center; justify-content: space-between;">
          <span (click)="playTrack.emit(i+1)" style="cursor: pointer;">
            {{ i + 1 }}. {{ item.title || 'Unbekannt' }}
            @if (item.artist) {
              <span> - {{ item.artist }}</span>
            }
            @if (item.album) {
              <span> ({{ item.album }})</span>
            }
          </span>
          <button class="remove-btn" (click)="onRemoveTrack(i+1); $event.stopPropagation()">-</button>
        </li>
      }
    </ul>
  }
  @if (!(queueLoading$ | async) && !(queueError$ | async) && (!queue || queue.length === 0)) {
    <div>Keine Einträge in der Queue.</div>
  }
</section>

